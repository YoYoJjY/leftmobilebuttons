local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TripoutGui"
screenGui.ResetOnSpawn = false  -- Keeps GUI after respawning
screenGui.Parent = playerGui

-- Function to create buttons
local function createButton(name, position, size, text, textSize, textColor, parent)
    local button = Instance.new("TextButton")
    button.Name = name
    button.AnchorPoint = Vector2.new(1, 0) -- Aligns to right side of screen
    button.Position = position
    button.Size = size
    button.Text = text
    button.TextSize = textSize
    button.TextColor3 = textColor
    button.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    button.BackgroundTransparency = 0.3
    button.BorderSizePixel = 2
    button.ZIndex = 10  -- Ensures visibility
    button.Parent = parent
    return button
end

-- Button definitions
local buttons = {
    {"MacarenaButton", UDim2.new(1, 0, 0, -20), "Macarena", Color3.fromRGB(255, 255, 255)},
    {"FreestyleButton", UDim2.new(1, 0, 0, 10), "Freestyle", Color3.fromRGB(255, 150, 150)},
    {"BreakdownButton", UDim2.new(1, 0, 0, 40), "Breakdown", Color3.fromRGB(150, 255, 255)},
    {"FreeflowButton", UDim2.new(1, 0, 0, 70), "Freeflow", Color3.fromRGB(200, 200, 255)},
    {"BegginButton", UDim2.new(1, 0, 0, 100), "Beggin", Color3.fromRGB(200, 255, 200)},
    {"CalamityButton", UDim2.new(1, 0, 0, 130), "Calamity", Color3.fromRGB(255, 200, 200)},
    {"ReanimatedButton", UDim2.new(1, 0, 0, 160), "Reanimated", Color3.fromRGB(255, 255, 150)},
    {"BreakdanceButton", UDim2.new(1, 0, 0, 190), "Breakdance", Color3.fromRGB(150, 200, 255)}, -- New button
    {"StopAnimButton", UDim2.new(1, 0, 0, 220), "StopAnim", Color3.fromRGB(255, 100, 100)}
}

local buttonInstances = {}
for _, buttonData in ipairs(buttons) do
    local name, position, text, color = unpack(buttonData)
    local button = createButton(name, position, UDim2.new(0, 100, 0, 25), text, 14, color, screenGui)
    buttonInstances[name] = button
end

-- Function to stop all animations
local function stopAnimations()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    
    if humanoid then
        for _, anim in pairs(humanoid:GetPlayingAnimationTracks()) do
            anim:Stop()
        end
        local animateScript = character:FindFirstChild("Animate")
        if animateScript then
            animateScript.Disabled = false
        end
    else
        warn("[ERROR] Humanoid not found!")
    end
end

-- Function to play an animation
local function playAnimation(animationID, speed, timePosition)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")

    if humanoid then
        for _, anim in pairs(humanoid:GetPlayingAnimationTracks()) do
            anim:Stop()
        end

        local animateScript = character:FindFirstChild("Animate")
        if animateScript then
            animateScript.Disabled = true
        end

        local animation = Instance.new("Animation")
        animation.AnimationId = "rbxassetid://" .. animationID
        local track = humanoid.Animator:LoadAnimation(animation) -- Updated to use Animator
        track:Play(0.1, 1, speed)
        track.TimePosition = timePosition
    else
        warn("[ERROR] Humanoid not found!")
    end
end

-- Assign animations to buttons
local animations = {
    {"MacarenaButton", "123051796350623", 2, 0},
    {"FreestyleButton", "111846683137285", 2, 0},
    {"BreakdownButton", "83228837001135", 2, 0},
    {"FreeflowButton", "77953251488968", 2, 0},
    {"BegginButton", "123332279844087", 2, 0},
    {"CalamityButton", "90841854866960", 2, 0},
    {"ReanimatedButton", "136203875493797", 2, 0},
    {"BreakdanceButton", "85890009404822", 2, 0} -- New animation
}

for _, animData in ipairs(animations) do
    local buttonName, animID, speed, timePos = unpack(animData)
    if buttonInstances[buttonName] then
        buttonInstances[buttonName].MouseButton1Click:Connect(function()
            playAnimation(animID, speed, timePos)
        end)
    end
end

-- Assign Stop Animation button
if buttonInstances["StopAnimButton"] then
    buttonInstances["StopAnimButton"].MouseButton1Click:Connect(stopAnimations)
end
